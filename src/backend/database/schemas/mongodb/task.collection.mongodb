db.createCollection('task', {
  validator: {
    $jsonSchema: {
      bsonType: 'object',
      required: ['_id', 'groupId', 'name'],
      additionalProperties: false,
      properties: {
        _id: { bsonType: 'objectId' },
        groupId: { 
          bsonType: 'objectId',
          description: 'id of the group where it belongs'
        },
        user: {
          bsonType: 'array',
          uniqueItems: true,
          items: {
            bsonType: 'string'
          },
          description: 'array of users with the task'
        },
        name: {
          bsonType: 'string',
          description: 'task name'
        },
        code: {
          bsonType: 'object',
          required: ['language', 'content'],
          additionalProperties: false,
          properties: {
            language: {bsonType: 'string'},
            content: {bsonType: 'string'}
          }
        },
        feature: {
          bsonType: 'array',
          uniqueItems: true,
          items: {
            bsonType: 'string'
          },
          description: 'features for the task'
        },
        description: {
          bsonType: 'string',
          description: 'description for the task'
        },
        isComplete: {
          bsonType: 'bool',
          description: 'to indicate the task state'
        },
        priority: {
          bsonType: 'int',
          description: 'Task priority'
        }
      }
    }
  }
})

db.task.createIndex({ groupId: 1 })